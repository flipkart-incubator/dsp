package com.flipkart.dsp.executor;

import com.flipkart.dsp.client.DSPConfigModule;
import com.flipkart.dsp.executor.application.ImageDetailsMesosApplication;
import com.flipkart.dsp.executor.config.TestApplicationModule;
import com.flipkart.dsp.executor.exception.ApplicationException;
import com.flipkart.dsp.executor.module.ExecutorModule;
import com.google.inject.Guice;
import com.google.inject.Injector;
import com.google.inject.Stage;

public class ImageDetailsMesosApplicationTest {

    public static void main(String[] args) throws ApplicationException {

        String bucketName = "dsp-stage-beta";
        String payload = "{\"execution_environment\":{\"image_path\":\"0.0.0.0/jessie-r:3.2.5\",\"start_up_script_path\":\"/usr/share/ipp-dsp-workflow-executor/bin/stage-beta/startup-r.sh\",\"execution_environment_id\":1,\"image_language\":\"R\",\"execution_environment_enum\":\"R_SERVE\",\"execution_environment_snapshot_list\":[{\"version\":1,\"librarySet\":\"{\\\"BH\\\":\\\"1.60.0-2\\\",\\\"Cubist\\\":\\\"0.0.18\\\",\\\"DBI\\\":\\\"0.4-1\\\",\\\"Formula\\\":\\\"1.2-1\\\",\\\"KFAS\\\":\\\"1.2.4\\\",\\\"KernSmooth\\\":\\\"2.23-15\\\",\\\"MASS\\\":\\\"7.3-45\\\",\\\"Matrix\\\":\\\"1.2-4\\\",\\\"MatrixModels\\\":\\\"0.4-1\\\",\\\"R6\\\":\\\"2.1.3\\\",\\\"RColorBrewer\\\":\\\"1.1-2\\\",\\\"Rcpp\\\":\\\"0.12.7\\\",\\\"RcppArmadillo\\\":\\\"0.7.100.3.1\\\",\\\"RcppEigen\\\":\\\"0.3.2.8.1\\\",\\\"Rserve\\\":\\\"1.7-3\\\",\\\"SparseM\\\":\\\"1.7\\\",\\\"TH.data\\\":\\\"1.0-7\\\",\\\"TeachingDemos\\\":\\\"2.10\\\",\\\"assertthat\\\":\\\"0.1\\\",\\\"base\\\":\\\"3.2.5\\\",\\\"bit\\\":\\\"1.1-12\\\",\\\"bit64\\\":\\\"0.9-5\\\",\\\"boot\\\":\\\"1.3-18\\\",\\\"brnn\\\":\\\"0.6\\\",\\\"car\\\":\\\"2.1-2\\\",\\\"caret\\\":\\\"6.0-68\\\",\\\"class\\\":\\\"7.3-14\\\",\\\"cluster\\\":\\\"2.0.3\\\",\\\"codetools\\\":\\\"0.2-14\\\",\\\"coin\\\":\\\"1.1-2\\\",\\\"colorspace\\\":\\\"1.2-6\\\",\\\"compiler\\\":\\\"3.2.5\\\",\\\"data.table\\\":\\\"1.10.4\\\",\\\"datasets\\\":\\\"3.2.5\\\",\\\"dichromat\\\":\\\"2.0-0\\\",\\\"digest\\\":\\\"0.6.10\\\",\\\"dlm\\\":\\\"1.1-4\\\",\\\"doMC\\\":\\\"1.3.4\\\",\\\"doSNOW\\\":\\\"1.0.14\\\",\\\"dplyr\\\":\\\"0.4.3\\\",\\\"e1071\\\":\\\"1.6-7\\\",\\\"earth\\\":\\\"4.4.7\\\",\\\"elasticnet\\\":\\\"1.1\\\",\\\"foreach\\\":\\\"1.4.3\\\",\\\"forecast\\\":\\\"7.1\\\",\\\"foreign\\\":\\\"0.8-66\\\",\\\"fracdiff\\\":\\\"1.4-2\\\",\\\"gdata\\\":\\\"2.17.0\\\",\\\"ggplot2\\\":\\\"2.1.0\\\",\\\"grDevices\\\":\\\"3.2.5\\\",\\\"graphics\\\":\\\"3.2.5\\\",\\\"grid\\\":\\\"3.2.5\\\",\\\"gtable\\\":\\\"0.2.0\\\",\\\"gtools\\\":\\\"3.5.0\\\",\\\"iterators\\\":\\\"1.0.8\\\",\\\"kernlab\\\":\\\"0.9-24\\\",\\\"labeling\\\":\\\"0.3\\\",\\\"lars\\\":\\\"1.2\\\",\\\"lattice\\\":\\\"0.20-34\\\",\\\"lazyeval\\\":\\\"0.1.10\\\",\\\"lme4\\\":\\\"1.1-12\\\",\\\"lubridate\\\":\\\"1.5.6\\\",\\\"magrittr\\\":\\\"1.5\\\",\\\"matrixStats\\\":\\\"0.50.2\\\",\\\"mda\\\":\\\"0.4-9\\\",\\\"methods\\\":\\\"3.2.5\\\",\\\"mgcv\\\":\\\"1.8-12\\\",\\\"minqa\\\":\\\"1.2.4\\\",\\\"modeltools\\\":\\\"0.2-21\\\",\\\"moments\\\":\\\"0.14\\\",\\\"multcomp\\\":\\\"1.4-5\\\",\\\"munsell\\\":\\\"0.4.3\\\",\\\"mvtnorm\\\":\\\"1.0-5\\\",\\\"nlme\\\":\\\"3.1-125\\\",\\\"nloptr\\\":\\\"1.0.4\\\",\\\"nnet\\\":\\\"7.3-12\\\",\\\"parallel\\\":\\\"3.2.5\\\",\\\"party\\\":\\\"1.0-25\\\",\\\"pbkrtest\\\":\\\"0.4-6\\\",\\\"plotmo\\\":\\\"3.3.1\\\",\\\"plotrix\\\":\\\"3.6-3\\\",\\\"plyr\\\":\\\"1.8.4\\\",\\\"quadprog\\\":\\\"1.5-5\\\",\\\"quantreg\\\":\\\"5.26\\\",\\\"rJava\\\":\\\"0.9-8\\\",\\\"randomForest\\\":\\\"4.6-12\\\",\\\"ranger\\\":\\\"0.4.0\\\",\\\"reshape2\\\":\\\"1.4.1\\\",\\\"rjson\\\":\\\"0.2.15\\\",\\\"rpart\\\":\\\"4.1-10\\\",\\\"rucm\\\":\\\"0.6\\\",\\\"sandwich\\\":\\\"2.3-4\\\",\\\"scales\\\":\\\"0.4.0\\\",\\\"snow\\\":\\\"0.4-1\\\",\\\"spatial\\\":\\\"7.3-11\\\",\\\"splines\\\":\\\"3.2.5\\\",\\\"stats\\\":\\\"3.2.5\\\",\\\"stats4\\\":\\\"3.2.5\\\",\\\"stringi\\\":\\\"1.1.2\\\",\\\"stringr\\\":\\\"1.1.0\\\",\\\"strucchange\\\":\\\"1.5-1\\\",\\\"survival\\\":\\\"2.38-3\\\",\\\"tcltk\\\":\\\"3.2.5\\\",\\\"timeDate\\\":\\\"3012.100\\\",\\\"tools\\\":\\\"3.2.5\\\",\\\"tseries\\\":\\\"0.10-35\\\",\\\"utils\\\":\\\"3.2.5\\\",\\\"zoo\\\":\\\"1.7-13\\\"}\",\"latestImageDigest\":\"abc\",\"executionEnvironmentId\":0,\"nativeLibrarySet\":null,\"os\":null,\"osVersion\":null,\"imageLanguageVersion\":null},{\"version\":2,\"librarySet\":\"{\\\"BH\\\":\\\"1.60.0-2\\\",\\\"Cubist\\\":\\\"0.0.18\\\",\\\"DBI\\\":\\\"0.4-1\\\",\\\"Formula\\\":\\\"1.2-1\\\",\\\"KFAS\\\":\\\"1.2.4\\\",\\\"KernSmooth\\\":\\\"2.23-15\\\",\\\"MASS\\\":\\\"7.3-45\\\",\\\"Matrix\\\":\\\"1.2-4\\\",\\\"MatrixModels\\\":\\\"0.4-1\\\",\\\"R6\\\":\\\"2.1.3\\\",\\\"RColorBrewer\\\":\\\"1.1-2\\\",\\\"Rcpp\\\":\\\"0.12.7\\\",\\\"RcppArmadillo\\\":\\\"0.7.100.3.1\\\",\\\"RcppEigen\\\":\\\"0.3.2.8.1\\\",\\\"Rserve\\\":\\\"1.7-3\\\",\\\"SparseM\\\":\\\"1.7\\\",\\\"TH.data\\\":\\\"1.0-7\\\",\\\"TeachingDemos\\\":\\\"2.10\\\",\\\"assertthat\\\":\\\"0.1\\\",\\\"base\\\":\\\"3.2.5\\\",\\\"bit\\\":\\\"1.1-12\\\",\\\"bit64\\\":\\\"0.9-5\\\",\\\"boot\\\":\\\"1.3-18\\\",\\\"brnn\\\":\\\"0.6\\\",\\\"car\\\":\\\"2.1-2\\\",\\\"caret\\\":\\\"6.0-68\\\",\\\"class\\\":\\\"7.3-14\\\",\\\"cluster\\\":\\\"2.0.3\\\",\\\"codetools\\\":\\\"0.2-14\\\",\\\"coin\\\":\\\"1.1-2\\\",\\\"colorspace\\\":\\\"1.2-6\\\",\\\"compiler\\\":\\\"3.2.5\\\",\\\"data.table\\\":\\\"1.10.4\\\",\\\"datasets\\\":\\\"3.2.5\\\",\\\"dichromat\\\":\\\"2.0-0\\\",\\\"digest\\\":\\\"0.6.10\\\",\\\"dlm\\\":\\\"1.1-4\\\",\\\"doMC\\\":\\\"1.3.4\\\",\\\"doSNOW\\\":\\\"1.0.14\\\",\\\"dplyr\\\":\\\"0.4.3\\\",\\\"e1071\\\":\\\"1.6-7\\\",\\\"earth\\\":\\\"4.4.7\\\",\\\"elasticnet\\\":\\\"1.1\\\",\\\"foreach\\\":\\\"1.4.3\\\",\\\"forecast\\\":\\\"7.1\\\",\\\"foreign\\\":\\\"0.8-66\\\",\\\"fracdiff\\\":\\\"1.4-2\\\",\\\"gdata\\\":\\\"2.17.0\\\",\\\"ggplot2\\\":\\\"2.1.0\\\",\\\"grDevices\\\":\\\"3.2.5\\\",\\\"graphics\\\":\\\"3.2.5\\\",\\\"grid\\\":\\\"3.2.5\\\",\\\"gtable\\\":\\\"0.2.0\\\",\\\"gtools\\\":\\\"3.5.0\\\",\\\"iterators\\\":\\\"1.0.8\\\",\\\"kernlab\\\":\\\"0.9-24\\\",\\\"labeling\\\":\\\"0.3\\\",\\\"lars\\\":\\\"1.2\\\",\\\"lattice\\\":\\\"0.20-34\\\",\\\"lazyeval\\\":\\\"0.1.10\\\",\\\"lme4\\\":\\\"1.1-12\\\",\\\"lubridate\\\":\\\"1.5.6\\\",\\\"magrittr\\\":\\\"1.5\\\",\\\"matrixStats\\\":\\\"0.50.2\\\",\\\"mda\\\":\\\"0.4-9\\\",\\\"methods\\\":\\\"3.2.5\\\",\\\"mgcv\\\":\\\"1.8-12\\\",\\\"minqa\\\":\\\"1.2.4\\\",\\\"modeltools\\\":\\\"0.2-21\\\",\\\"moments\\\":\\\"0.14\\\",\\\"multcomp\\\":\\\"1.4-5\\\",\\\"munsell\\\":\\\"0.4.3\\\",\\\"mvtnorm\\\":\\\"1.0-5\\\",\\\"nlme\\\":\\\"3.1-125\\\",\\\"nloptr\\\":\\\"1.0.4\\\",\\\"nnet\\\":\\\"7.3-12\\\",\\\"parallel\\\":\\\"3.2.5\\\",\\\"party\\\":\\\"1.0-25\\\",\\\"pbkrtest\\\":\\\"0.4-6\\\",\\\"plotmo\\\":\\\"3.3.1\\\",\\\"plotrix\\\":\\\"3.6-3\\\",\\\"plyr\\\":\\\"1.8.4\\\",\\\"quadprog\\\":\\\"1.5-5\\\",\\\"quantreg\\\":\\\"5.26\\\",\\\"rJava\\\":\\\"0.9-8\\\",\\\"randomForest\\\":\\\"4.6-12\\\",\\\"ranger\\\":\\\"0.4.0\\\",\\\"reshape2\\\":\\\"1.4.1\\\",\\\"rjson\\\":\\\"0.2.15\\\",\\\"rpart\\\":\\\"4.1-10\\\",\\\"rucm\\\":\\\"0.6\\\",\\\"sandwich\\\":\\\"2.3-4\\\",\\\"scales\\\":\\\"0.4.0\\\",\\\"snow\\\":\\\"0.4-1\\\",\\\"spatial\\\":\\\"7.3-11\\\",\\\"splines\\\":\\\"3.2.5\\\",\\\"stats\\\":\\\"3.2.5\\\",\\\"stats4\\\":\\\"3.2.5\\\",\\\"stringi\\\":\\\"1.1.2\\\",\\\"stringr\\\":\\\"1.1.0\\\",\\\"strucchange\\\":\\\"1.5-1\\\",\\\"survival\\\":\\\"2.38-3\\\",\\\"tcltk\\\":\\\"3.2.5\\\",\\\"timeDate\\\":\\\"3012.100\\\",\\\"tools\\\":\\\"3.2.5\\\",\\\"tseries\\\":\\\"0.10-35\\\",\\\"utils\\\":\\\"3.2.5\\\",\\\"zoo\\\":\\\"1.7-13\\\"}\",\"latestImageDigest\":\"sha256:b86bbd169c205703b57c9384240cd408c8e600ab838df9b019deb36cd5b36c2\",\"executionEnvironmentId\":0,\"nativeLibrarySet\":null,\"os\":null,\"osVersion\":null,\"imageLanguageVersion\":null}]}}" ;
        String arr[] = new String[1];
        arr[0] = payload;
        Injector injector = Guice.createInjector(Stage.DEVELOPMENT, new DSPConfigModule(bucketName), new TestApplicationModule());
        ExecutorModule executorModule = new ExecutorModule();
        injector.injectMembers(executorModule);
        injector = injector.createChildInjector(executorModule);
        ImageDetailsMesosApplication imageDetailsMesosApplication = injector.getInstance(ImageDetailsMesosApplication.class);
        imageDetailsMesosApplication.execute(arr);
    }
}
